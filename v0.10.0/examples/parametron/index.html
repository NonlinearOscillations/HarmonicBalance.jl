<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Parametrically driven Duffing resonator: 1D and 2D plots · HarmonicBalance.jl</title><meta name="title" content="Parametrically driven Duffing resonator: 1D and 2D plots · HarmonicBalance.jl"/><meta property="og:title" content="Parametrically driven Duffing resonator: 1D and 2D plots · HarmonicBalance.jl"/><meta property="twitter:title" content="Parametrically driven Duffing resonator: 1D and 2D plots · HarmonicBalance.jl"/><meta name="description" content="Documentation for HarmonicBalance.jl."/><meta property="og:description" content="Documentation for HarmonicBalance.jl."/><meta property="twitter:description" content="Documentation for HarmonicBalance.jl."/><meta property="og:url" content="https://nonlinearoscillations.github.io/HarmonicBalance.jl/stable/examples/parametron/"/><meta property="twitter:url" content="https://nonlinearoscillations.github.io/HarmonicBalance.jl/stable/examples/parametron/"/><link rel="canonical" href="https://nonlinearoscillations.github.io/HarmonicBalance.jl/stable/examples/parametron/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../../assets/docs.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../background/harmonic_balance/"><img src="../../assets/logo.png" alt="HarmonicBalance.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../background/harmonic_balance/">HarmonicBalance.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><span class="tocitem">Background</span><ul><li><a class="tocitem" href="../../background/harmonic_balance/">The method of harmonic balance</a></li><li><a class="tocitem" href="../../background/stability_response/">Stability and linear response</a></li><li><a class="tocitem" href="../../background/limit_cycles/">Limit cycles</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../simple_Duffing/">Introduction: the Duffing oscillator</a></li><li><a class="tocitem" href="../linear_response/">Introduction: linear response</a></li><li><a class="tocitem" href="../time_dependent/">Introduction: time-dependent simulations</a></li><li class="is-active"><a class="tocitem" href>Parametrically driven Duffing resonator: 1D and 2D plots</a><ul class="internal"><li><a class="tocitem" href="#1D-parameters"><span>1D parameters</span></a></li><li><a class="tocitem" href="#2D-parameters"><span>2D parameters</span></a></li></ul></li><li><a class="tocitem" href="../limit_cycles/">Limit cycles</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/entering_eom/">Entering equations of motion</a></li><li><a class="tocitem" href="../../manual/extracting_harmonics/">Extracting harmonic equations</a></li><li><a class="tocitem" href="../../manual/solving_harmonics/">Solving harmonic equations</a></li><li><a class="tocitem" href="../../manual/Krylov-Bogoliubov_method/">Krylov-Bogoliubov Averaging Method</a></li><li><a class="tocitem" href="../../manual/plotting/">Analysis and plotting</a></li><li><a class="tocitem" href="../../manual/time_dependent/">Time evolution</a></li><li><a class="tocitem" href="../../manual/linear_response/">Linear response (WIP)</a></li><li><a class="tocitem" href="../../manual/saving/">Saving and loading</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Parametrically driven Duffing resonator: 1D and 2D plots</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Parametrically driven Duffing resonator: 1D and 2D plots</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/NonlinearOscillations/HarmonicBalance.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/NonlinearOscillations/HarmonicBalance.jl/blob/master/docs/src/examples/parametron.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="parametron"><a class="docs-heading-anchor" href="#parametron">Parametrically driven Duffing resonator: 1D and 2D plots</a><a id="parametron-1"></a><a class="docs-heading-anchor-permalink" href="#parametron" title="Permalink"></a></h1><p>One of the most famous effects displaced by nonlinear oscillators is parametric resonance, where the frequency of the linear resonator is modulated in time  <a href="https://doi.org/10.1103/PhysRevE.94.022201">Phys. Rev. E 94, 022201 (2016)</a>. In the following we analyse this system, governed by the equations</p><p class="math-container">\[\ddot{x}(t)+\gamma\dot{x}(t)+\Omega^2(1-\lambda\cos(2\omega t + \psi))x + \alpha x^3 +\eta x^2 \dot{x}+F_\text{d}(t)=0\]</p><p>where for completeness we also considered an external drive term <span>$F_\text{d}(t)=F\cos(\omega t + \theta)$</span> and a nonlinear damping term <span>$\eta x^2 \dot{x}$</span></p><p>To implement this system in Harmonic Balance, we first import the library </p><pre><code class="language-julia hljs">using HarmonicBalance</code></pre><p>Subsequently, we type define parameters in the problem and the oscillating amplitude function <span>$x(t)$</span> using the <code>variables</code> macro from <code>Symbolics.jl</code> </p><pre><code class="language-julia hljs">@variables Ω, γ, λ, F, x, θ, η, α, ω, ψ, t, x(t)

natural_equation =  d(d(x,t),t) + γ*d(x,t) + Ω^2*(1-λ*cos(2*ω*t+ψ))*x + α*x^3 + η*d(x,t) * x^2
forces =  F*cos(ω*t + θ)
diff_eq = DifferentialEquation(natural_equation + forces, x)</code></pre><p>Note that an equation of the form  <span>$m \ddot{x}+m \omega_{0}^{2}\left(1-\lambda \cos (2\omega t+\psi)\right) x+\gamma \dot{x}+\alpha x^{3}+\eta x^{2} \dot{x}=F \cos \omega t$</span> can be brought to dimensionless form by rescaling the units as described in <a href="https://doi.org/10.1103/PhysRevE.94.022201">Phys. Rev. E 94, 022201 (2016)</a>.</p><p>We are interested in studying the response of the oscillator to parametric driving and forcing. In particular, we focus on the first parametric resonance of the system, i.e. operating around twice the bare frequency of the undriven oscillator <span>$\omega$</span> while the frequency of the external drive is also <span>$\omega$</span>. For this purpose, we consider a harmonic ansatz which contains a single frequency: <span>$x(t)\approx u\cos(\omega t)+v\sin(\omega t)$</span>.   In HarmonicBalance, we can do this via <code>add_harmonic</code> command:</p><pre><code class="language-julia hljs">add_harmonic!(diff_eq, x, ω);</code></pre><p>and replacing this by the time independent (averaged) equations of motion. This can be simply done by writing</p><pre><code class="language-julia hljs">harmonic_eq = get_harmonic_equations(diff_eq)</code></pre><p>The output of these equations are consistent with the result found in the literature. Now we are interested in the linear response spectrum, which we can obtain from the solutions to the averaged equations (rotating frame) as a function of the external drive, after fixing all other parameters in the system. A call to <code>get_steady_states</code> then retrieves all steadystates found allong the sweep employing the homotopy continuation method, which occurs in a complex space (see the nice <a href="https://www.juliahomotopycontinuation.org">HomotopyContinuation.jl docs</a>)</p><h2 id="1D-parameters"><a class="docs-heading-anchor" href="#1D-parameters">1D parameters</a><a id="1D-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#1D-parameters" title="Permalink"></a></h2><p>We start with a <code>varied</code> set containing one parameter, <span>$\omega$</span>,</p><pre><code class="language-julia hljs">fixed = (Ω =&gt; 1.0, γ =&gt; 1E-2, λ =&gt; 5E-2, F =&gt; 1E-3,  α =&gt; 1.0, η=&gt;0.3, θ =&gt; 0, ψ =&gt; 0)
varied = ω =&gt; range(0.9, 1.1, 100)

result = get_steady_states(harmonic_eq, varied, fixed)</code></pre><p>In <code>get_steady_states</code>, the default keyword<code>random_warmup=true</code> initiates the homotopy in a generalised version of the harmonic equations, where parameters become random complex numbers. A parameter homotopy then follows to each of the frequency values <span>$\omega$</span> in sweep. This offers speed-up, but requires to be tested in each scenario againts the option <code>random_warmup=false</code>, which initializes the homotopy in a total degree system (maximum number of roots), but needs to track significantly more homotopy paths and there is slower. The <code>threading</code> keyword enables parallel tracking of homotopy paths, and it&#39;s set to <code>false</code> simply because we are using a single core computer for now.</p><p>After solving the system, we can save the full output of the simulation and the model (e.g. symbolic expressions for the harmonic equations) into a file</p><pre><code class="language-julia hljs">HarmonicBalance.save(&quot;parametron_result.jld2&quot;, result);</code></pre><p>During the execution of <code>get_steady_states</code>, different solution branches are classified by their proximity in complex space, with subsequent filtering of real (physically accceptable solutions). In addition, the stability properties of each steady state is assesed from the eigenvalues of the Jacobian matrix. All this information can be succintly represented in a 1D plot via</p><pre><code class="language-julia hljs">plot(result, x=&quot;ω&quot;, y=&quot;sqrt(u1^2 + v1^2)&quot;)</code></pre><p>This produces the following figure</p><img style="display: block; margin: 0 auto;" src="../../assets/parametron/response.png" alignment="center"\><p>The user can also introduce custom clases based on parameter conditions via <code>classify_solutions!</code>. Plots can be overlaid and use keywords from <code>Plots</code>,</p><pre><code class="language-julia hljs">classify_solutions!(result, &quot;sqrt(u1^2 + v1^2) &gt; 0.1&quot;, &quot;large&quot;)
plot(result, &quot;sqrt(u1^2 + v1^2)&quot;, class=[&quot;physical&quot;, &quot;large&quot;], style=:dash)
plot!(result, &quot;sqrt(u1^2 + v1^2)&quot;, not_class=&quot;large&quot;)</code></pre><p>This overrides the default plotting style (stable=full, unstable=dashed) to give</p><img style="display: block; margin: 0 auto;" src="../../assets/parametron/classified.png" alignment="center"\><p>Alternatively, we may visualise all underlying solutions, including complex ones,</p><pre><code class="language-julia hljs">plot(result, &quot;sqrt(u1^2 + v1^2)&quot;, class=&quot;all&quot;)</code></pre><img style="display: block; margin: 0 auto;" src="../../assets/parametron/all.png" alignment="center"\><p>⠀</p><h2 id="2D-parameters"><a class="docs-heading-anchor" href="#2D-parameters">2D parameters</a><a id="2D-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#2D-parameters" title="Permalink"></a></h2><p>The parametrically driven oscillator boasts a stability diagram called &quot;Arnold&#39;s tongues&quot; delineating zones where the oscillator is stable from those where it is exponentially unstable (if the nonlinearity was absence).  We can retrieve this diagram by calculating the steady states as a function of external detuning <span>$\delta=\omega_L-\omega_0$</span> and the parametric drive strength <span>$\lambda$</span>.</p><p>To perform a 2D sweep over driving frequency <span>$\omega$</span> and parametric drive strength <span>$\lambda$</span>, we keep <code>fixed</code> from before but include 2 variables in <code>varied</code></p><pre><code class="language-julia hljs">varied = (ω =&gt; range(0.8, 1.2, 50), λ =&gt; range(0.001, 0.6, 50))
result_2D = get_steady_states(harmonic_eq, varied, fixed);</code></pre><p>Now, we count the number of solutions for each point and represent the corresponding phase diagram in parameter space. This is done using <code>plot_phase_diagram</code>. Only counting stable solutions,</p><pre><code class="language-julia hljs">plot_phase_diagram(result_2D, class=&quot;stable&quot;)</code></pre><img style="display: block; margin: 0 auto;" src="../../assets/parametron/2d_phase_diagram.png" alignment="center"\><p>⠀</p><p>In addition to phase diagrams, we can plot functions of the solution. The syntax is identical to 1D plotting. Let us overlay 2 branches into a single plot,</p><pre><code class="language-julia hljs"># overlay branches with different colors
plot(result_2D, &quot;sqrt(u1^2 + v1^2)&quot;, branch=1, class=&quot;stable&quot;, camera=(60,-40))
plot!(result_2D, &quot;sqrt(u1^2 + v1^2)&quot;, branch=2, class=&quot;stable&quot;, color=:red)</code></pre><img style="display: block; margin: 0 auto;" src="../../assets/parametron/2d_amp.png" alignment="center" width="500px"\><p>⠀</p><p>Note that solutions are ordered in parameter space according to their closest neighbors. Plots can again be limited to a given class (e.g stable solutions only) through the keyword argument <code>class</code>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../time_dependent/">« Introduction: time-dependent simulations</a><a class="docs-footer-nextpage" href="../limit_cycles/">Limit cycles »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Friday 14 June 2024 12:27">Friday 14 June 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
