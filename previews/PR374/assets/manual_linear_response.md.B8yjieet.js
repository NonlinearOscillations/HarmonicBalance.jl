import{_ as o,C as p,c as l,o as r,ai as i,j as e,a,G as t}from"./chunks/framework.DxQjAX3B.js";const A=JSON.parse('{"title":"Linear response (WIP)","description":"","frontmatter":{},"headers":[],"relativePath":"manual/linear_response.md","filePath":"manual/linear_response.md"}'),h={name:"manual/linear_response.md"},d={class:"jldocstring custom-block",open:""},c={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},k={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.027ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.319ex",height:"1.597ex",role:"img",focusable:"false",viewBox:"0 -694 583 706","aria-hidden":"true"},g={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},u={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.247ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2319 1000","aria-hidden":"true"},m={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},E={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"5.278ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2333 1000","aria-hidden":"true"},y={class:"jldocstring custom-block",open:""},b={class:"jldocstring custom-block",open:""},T={class:"jldocstring custom-block",open:""},f={class:"jldocstring custom-block",open:""},_={class:"jldocstring custom-block",open:""},x={class:"jldocstring custom-block",open:""},Q={class:"jldocstring custom-block",open:""},v={class:"jldocstring custom-block",open:""};function F(H,s,C,j,w,L){const n=p("Badge");return r(),l("div",null,[s[37]||(s[37]=i('<h1 id="linresp_man" tabindex="-1">Linear response (WIP) <a class="header-anchor" href="#linresp_man" aria-label="Permalink to &quot;Linear response (WIP) {#linresp_man}&quot;">​</a></h1><p>This module currently has two goals. One is calculating the first-order Jacobian, used to obtain stability and approximate (but inexpensive) the linear response of steady states. The other is calculating the full response matrix as a function of frequency; this is more accurate but more expensive.</p><p>The methodology used is explained in <a href="https://www.doi.org/10.3929/ethz-b-000589190" target="_blank" rel="noreferrer">Jan Kosata phd thesis</a>.</p><h2 id="stability" tabindex="-1">Stability <a class="header-anchor" href="#stability" aria-label="Permalink to &quot;Stability&quot;">​</a></h2><p>The Jacobian is used to evaluate stability of the solutions. It can be shown explicitly,</p>',5)),e("details",d,[e("summary",null,[s[0]||(s[0]=e("a",{id:"HarmonicBalance.get_Jacobian-manual-linear_response",href:"#HarmonicBalance.get_Jacobian-manual-linear_response"},[e("span",{class:"jlbinding"},"HarmonicBalance.get_Jacobian")],-1)),s[1]||(s[1]=a()),t(n,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[2]||(s[2]=i('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">get_Jacobian</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(eom)</span></span></code></pre></div><p>Obtain the symbolic Jacobian matrix of <code>eom</code>. This is the linearised left-hand side of F(u) = du/dT.</p><p><a href="https://github.com/NonlinearOscillations/HarmonicBalance.jl/blob/566f4e4ae8cae881d72420747776af3a152429ac/src/Jacobian.jl#L41" target="_blank" rel="noreferrer">source</a></p><p>Obtain a Jacobian from a <code>DifferentialEquation</code> by first converting it into a <code>HarmonicEquation</code>.</p><p><a href="https://github.com/NonlinearOscillations/HarmonicBalance.jl/blob/566f4e4ae8cae881d72420747776af3a152429ac/src/Jacobian.jl#L59" target="_blank" rel="noreferrer">source</a></p><p>Get the Jacobian of a set of equations <code>eqs</code> with respect to the variables <code>vars</code>.</p><p><a href="https://github.com/NonlinearOscillations/HarmonicBalance.jl/blob/566f4e4ae8cae881d72420747776af3a152429ac/src/Jacobian.jl#L68" target="_blank" rel="noreferrer">source</a></p>',7))]),s[38]||(s[38]=e("h2",{id:"Linear-response",tabindex:"-1"},[a("Linear response "),e("a",{class:"header-anchor",href:"#Linear-response","aria-label":'Permalink to "Linear response {#Linear-response}"'},"​")],-1)),s[39]||(s[39]=e("p",null,[a("The response to white noise can be shown with "),e("code",null,"plot_linear_response"),a(". Depending on the "),e("code",null,"order"),a(" argument, different methods are used.")],-1)),s[40]||(s[40]=e("h3",{id:"First-order",tabindex:"-1"},[a("First order "),e("a",{class:"header-anchor",href:"#First-order","aria-label":'Permalink to "First order {#First-order}"'},"​")],-1)),e("p",null,[s[9]||(s[9]=a("The simplest way to extract the linear response of a steady state is to evaluate the Jacobian of the harmonic equations. Each of its eigenvalues ")),e("mjx-container",c,[(r(),l("svg",k,s[3]||(s[3]=[e("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[e("g",{"data-mml-node":"math"},[e("g",{"data-mml-node":"mi"},[e("path",{"data-c":"1D706",d:"M166 673Q166 685 183 694H202Q292 691 316 644Q322 629 373 486T474 207T524 67Q531 47 537 34T546 15T551 6T555 2T556 -2T550 -11H482Q457 3 450 18T399 152L354 277L340 262Q327 246 293 207T236 141Q211 112 174 69Q123 9 111 -1T83 -12Q47 -12 47 20Q47 37 61 52T199 187Q229 216 266 252T321 306L338 322Q338 323 288 462T234 612Q214 657 183 657Q166 657 166 673Z",style:{"stroke-width":"3"}})])])],-1)]))),s[4]||(s[4]=e("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[e("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[e("mi",null,"λ")])],-1))]),s[10]||(s[10]=a(" describes a Lorentzian peak in the response; ")),e("mjx-container",g,[(r(),l("svg",u,s[5]||(s[5]=[i('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mtext"><path data-c="52" d="M130 622Q123 629 119 631T103 634T60 637H27V683H202H236H300Q376 683 417 677T500 648Q595 600 609 517Q610 512 610 501Q610 468 594 439T556 392T511 361T472 343L456 338Q459 335 467 332Q497 316 516 298T545 254T559 211T568 155T578 94Q588 46 602 31T640 16H645Q660 16 674 32T692 87Q692 98 696 101T712 105T728 103T732 90Q732 59 716 27T672 -16Q656 -22 630 -22Q481 -16 458 90Q456 101 456 163T449 246Q430 304 373 320L363 322L297 323H231V192L232 61Q238 51 249 49T301 46H334V0H323Q302 3 181 3Q59 3 38 0H27V46H60Q102 47 111 49T130 61V622ZM491 499V509Q491 527 490 539T481 570T462 601T424 623T362 636Q360 636 340 636T304 637H283Q238 637 234 628Q231 624 231 492V360H289Q390 360 434 378T489 456Q491 467 491 499Z" style="stroke-width:3;"></path><path data-c="65" d="M28 218Q28 273 48 318T98 391T163 433T229 448Q282 448 320 430T378 380T406 316T415 245Q415 238 408 231H126V216Q126 68 226 36Q246 30 270 30Q312 30 342 62Q359 79 369 104L379 128Q382 131 395 131H398Q415 131 415 121Q415 117 412 108Q393 53 349 21T250 -11Q155 -11 92 58T28 218ZM333 275Q322 403 238 411H236Q228 411 220 410T195 402T166 381T143 340T127 274V267H333V275Z" transform="translate(736,0)" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(1180,0)"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(1458,0)"><path data-c="1D706" d="M166 673Q166 685 183 694H202Q292 691 316 644Q322 629 373 486T474 207T524 67Q531 47 537 34T546 15T551 6T555 2T556 -2T550 -11H482Q457 3 450 18T399 152L354 277L340 262Q327 246 293 207T236 141Q211 112 174 69Q123 9 111 -1T83 -12Q47 -12 47 20Q47 37 61 52T199 187Q229 216 266 252T321 306L338 322Q338 323 288 462T234 612Q214 657 183 657Q166 657 166 673Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(2041,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width:3;"></path></g></g></g>',1)]))),s[6]||(s[6]=e("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[e("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[e("mtext",null,"Re"),e("mo",{stretchy:"false"},"["),e("mi",null,"λ"),e("mo",{stretchy:"false"},"]")])],-1))]),s[11]||(s[11]=a(" gives its center and ")),e("mjx-container",m,[(r(),l("svg",E,s[7]||(s[7]=[i('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mtext"><path data-c="49" d="M328 0Q307 3 180 3T32 0H21V46H43Q92 46 106 49T126 60Q128 63 128 342Q128 620 126 623Q122 628 118 630T96 635T43 637H21V683H32Q53 680 180 680T328 683H339V637H317Q268 637 254 634T234 623Q232 620 232 342Q232 63 234 60Q238 55 242 53T264 48T317 46H339V0H328Z" style="stroke-width:3;"></path><path data-c="6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z" transform="translate(361,0)" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(1194,0)"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(1472,0)"><path data-c="1D706" d="M166 673Q166 685 183 694H202Q292 691 316 644Q322 629 373 486T474 207T524 67Q531 47 537 34T546 15T551 6T555 2T556 -2T550 -11H482Q457 3 450 18T399 152L354 277L340 262Q327 246 293 207T236 141Q211 112 174 69Q123 9 111 -1T83 -12Q47 -12 47 20Q47 37 61 52T199 187Q229 216 266 252T321 306L338 322Q338 323 288 462T234 612Q214 657 183 657Q166 657 166 673Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(2055,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width:3;"></path></g></g></g>',1)]))),s[8]||(s[8]=e("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[e("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[e("mtext",null,"Im"),e("mo",{stretchy:"false"},"["),e("mi",null,"λ"),e("mo",{stretchy:"false"},"]")])],-1))]),s[12]||(s[12]=a(" its width. Transforming the harmonic variables into the non-rotating frame (that is, inverting the harmonic ansatz) then gives the response as it would be observed in an experiment."))]),s[41]||(s[41]=e("p",null,"The advantage of this method is that for a given parameter set, only one matrix diagonalization is needed to fully describe the response spectrum. However, the method is inaccurate for response frequencies far from the frequencies used in the harmonic ansatz (it relies on the response oscillating slowly in the rotating frame).",-1)),s[42]||(s[42]=e("p",null,[a("Behind the scenes, the spectra are stored using the dedicated structs "),e("code",null,"Lorentzian"),a(" and "),e("code",null,"JacobianSpectrum"),a(".")],-1)),e("details",y,[e("summary",null,[s[13]||(s[13]=e("a",{id:"HarmonicBalance.LinearResponse.get_jacobian_response-manual-linear_response",href:"#HarmonicBalance.LinearResponse.get_jacobian_response-manual-linear_response"},[e("span",{class:"jlbinding"},"HarmonicBalance.LinearResponse.get_jacobian_response")],-1)),s[14]||(s[14]=a()),t(n,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[15]||(s[15]=i(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">get_jacobian_response</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    res</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">HarmonicBalance.Result{D, S, P, F}</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> F</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FunctionWrappers.FunctionWrapper{Array{S, 2}, Tuple{Array{S, 1}}}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    nat_var</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Num</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Ω_range,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    branch</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Int64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    show_progress</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Matrix</span></span></code></pre></div><p>Calculate the Jacobian response spectrum for a given system. Computes the magnitude of the Jacobian response for stable solutions across specified frequency ranges.</p><p><strong>Arguments</strong></p><ul><li><p><code>res::Result</code>: Result object containing the system&#39;s solutions</p></li><li><p><code>nat_var::Num</code>: Natural variable to evaluate in the response</p></li><li><p><code>Ω_range</code>: Range of frequencies to evaluate</p></li><li><p><code>branch::Int</code> or <code>followed_branches::Vector{Int}</code>: Branch number(s) to analyze</p></li><li><p><code>show_progress=true</code>: Whether to show a progress bar</p></li><li><p><code>force=false</code>: Force recalculation of spectrum even if already exists</p></li></ul><p><strong>Returns</strong></p><ul><li>Array{P,2}: Complex response matrix where rows correspond to frequencies and columns to solutions</li></ul><p><a href="https://github.com/NonlinearOscillations/HarmonicBalance.jl/blob/566f4e4ae8cae881d72420747776af3a152429ac/src/modules/LinearResponse/plotting.jl#L1" target="_blank" rel="noreferrer">source</a></p>`,7))]),e("details",b,[e("summary",null,[s[16]||(s[16]=e("a",{id:"HarmonicBalance.LinearResponse.get_rotframe_jacobian_response-manual-linear_response",href:"#HarmonicBalance.LinearResponse.get_rotframe_jacobian_response-manual-linear_response"},[e("span",{class:"jlbinding"},"HarmonicBalance.LinearResponse.get_rotframe_jacobian_response")],-1)),s[17]||(s[17]=a()),t(n,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[18]||(s[18]=i(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">get_rotframe_jacobian_response</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    res</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">HarmonicBalance.Result{D, S, P, F}</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> F</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FunctionWrappers.FunctionWrapper{Array{S, 2}, Tuple{Array{S, 1}}}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Ω_range,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    branch</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Int64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    show_progress,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    damping_mod</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Calculate the rotating frame Jacobian response for a given branch. Computes the rotating frame Jacobian response by evaluating eigenvalues of the numerical Jacobian and calculating the response magnitude for each frequency in the range.</p><p><strong>Arguments</strong></p><ul><li><p><code>res::Result</code>: Result object containing the system&#39;s solutions</p></li><li><p><code>Ω_range</code>: Range of frequencies to evaluate</p></li><li><p><code>branch::Int</code>: Branch number to analyze</p></li><li><p><code>show_progress=true</code>: Whether to show a progress bar</p></li><li><p><code>damping_mod</code>: Damping modification parameter</p></li></ul><p><strong>Returns</strong></p><ul><li>Array{P,2}: Response matrix in the rotating frame</li></ul><p><a href="https://github.com/NonlinearOscillations/HarmonicBalance.jl/blob/566f4e4ae8cae881d72420747776af3a152429ac/src/modules/LinearResponse/plotting.jl#L118" target="_blank" rel="noreferrer">source</a></p>`,7))]),e("details",T,[e("summary",null,[s[19]||(s[19]=e("a",{id:"HarmonicBalance.LinearResponse.JacobianSpectrum-manual-linear_response",href:"#HarmonicBalance.LinearResponse.JacobianSpectrum-manual-linear_response"},[e("span",{class:"jlbinding"},"HarmonicBalance.LinearResponse.JacobianSpectrum")],-1)),s[20]||(s[20]=a()),t(n,{type:"info",class:"jlObjectType jlType",text:"Type"})]),s[21]||(s[21]=i('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">mutable struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> JacobianSpectrum{T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Real</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>Holds a set of <code>Lorentzian</code> objects belonging to a variable.</p><p><strong>Fields</strong></p><ul><li><code>peaks::Array{HarmonicBalance.LinearResponse.Lorentzian{T}, 1} where T&lt;:Real</code></li></ul><p><strong>Constructor</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JacobianSpectrum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(res</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; index</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, branch</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><a href="https://github.com/NonlinearOscillations/HarmonicBalance.jl/blob/566f4e4ae8cae881d72420747776af3a152429ac/src/modules/LinearResponse/types.jl#L21" target="_blank" rel="noreferrer">source</a></p>',7))]),e("details",f,[e("summary",null,[s[22]||(s[22]=e("a",{id:"HarmonicBalance.LinearResponse.Lorentzian-manual-linear_response",href:"#HarmonicBalance.LinearResponse.Lorentzian-manual-linear_response"},[e("span",{class:"jlbinding"},"HarmonicBalance.LinearResponse.Lorentzian")],-1)),s[23]||(s[23]=a()),t(n,{type:"info",class:"jlObjectType jlType",text:"Type"})]),s[24]||(s[24]=i('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Lorentzian{T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Real</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>Holds the three parameters of a Lorentzian peak, defined as A / sqrt((ω-ω0)² + Γ²).</p><p><strong>Fields</strong></p><ul><li><p><code>ω0::Real</code></p></li><li><p><code>Γ::Real</code></p></li><li><p><code>A::Real</code></p></li></ul><p><a href="https://github.com/NonlinearOscillations/HarmonicBalance.jl/blob/566f4e4ae8cae881d72420747776af3a152429ac/src/modules/LinearResponse/types.jl#L1" target="_blank" rel="noreferrer">source</a></p>',5))]),s[43]||(s[43]=e("h3",{id:"Higher-orders",tabindex:"-1"},[a("Higher orders "),e("a",{class:"header-anchor",href:"#Higher-orders","aria-label":'Permalink to "Higher orders {#Higher-orders}"'},"​")],-1)),s[44]||(s[44]=e("p",null,[a("Setting "),e("code",null,"order > 1"),a(" increases the accuracy of the response spectra. However, unlike for the Jacobian, here we must perform a matrix inversion for each response frequency.")],-1)),e("details",_,[e("summary",null,[s[25]||(s[25]=e("a",{id:"HarmonicBalance.LinearResponse.get_linear_response-manual-linear_response",href:"#HarmonicBalance.LinearResponse.get_linear_response-manual-linear_response"},[e("span",{class:"jlbinding"},"HarmonicBalance.LinearResponse.get_linear_response")],-1)),s[26]||(s[26]=a()),t(n,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[27]||(s[27]=i(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">get_linear_response</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    res</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">HarmonicBalance.Result{D, S, P, F}</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> F</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FunctionWrappers.FunctionWrapper{Array{S, 2}, Tuple{Array{S, 1}}}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    nat_var</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Num</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Ω_range,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    branch</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Int64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    order,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    show_progress</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Calculate the linear response of the system for a given branch. Evaluates the linear response by solving the linear response ODE for each stable solution and input frequency in the given range.</p><p><strong>Arguments</strong></p><ul><li><p><code>res</code>: Result object containing the system&#39;s solutions</p></li><li><p><code>nat_var::Num</code>: Natural variable to evaluate in the response</p></li><li><p><code>Ω_range</code>: Range of frequencies to evaluate</p></li><li><p><code>branch::Int</code>: Branch number to analyze</p></li><li><p><code>order</code>: Order of the response to calculate</p></li><li><p><code>show_progress=true</code>: Whether to show a progress bar</p></li></ul><p><strong>Returns</strong></p><ul><li>Array{P,2}: Response matrix where rows correspond to frequencies and columns to stable solutions</li></ul><p><a href="https://github.com/NonlinearOscillations/HarmonicBalance.jl/blob/566f4e4ae8cae881d72420747776af3a152429ac/src/modules/LinearResponse/plotting.jl#L71" target="_blank" rel="noreferrer">source</a></p>`,7))]),e("details",x,[e("summary",null,[s[28]||(s[28]=e("a",{id:"HarmonicBalance.LinearResponse.ResponseMatrix-manual-linear_response",href:"#HarmonicBalance.LinearResponse.ResponseMatrix-manual-linear_response"},[e("span",{class:"jlbinding"},"HarmonicBalance.LinearResponse.ResponseMatrix")],-1)),s[29]||(s[29]=a()),t(n,{type:"info",class:"jlObjectType jlType",text:"Type"})]),s[30]||(s[30]=i('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ResponseMatrix</span></span></code></pre></div><p>Holds the compiled response matrix of a system.</p><p><strong>Fields</strong></p><ul><li><p><code>matrix::Matrix{Function}</code>: The response matrix (compiled).</p></li><li><p><code>symbols::Vector{Num}</code>: Any symbolic variables in <code>matrix</code> to be substituted at evaluation.</p></li><li><p><code>variables::Vector{HarmonicVariable}</code>: The frequencies of the harmonic variables underlying <code>matrix</code>. These are needed to transform the harmonic variables to the non-rotating frame.</p></li></ul><p><a href="https://github.com/NonlinearOscillations/HarmonicBalance.jl/blob/566f4e4ae8cae881d72420747776af3a152429ac/src/modules/LinearResponse/types.jl#L40" target="_blank" rel="noreferrer">source</a></p>',5))]),e("details",Q,[e("summary",null,[s[31]||(s[31]=e("a",{id:"HarmonicBalance.LinearResponse.get_response-manual-linear_response",href:"#HarmonicBalance.LinearResponse.get_response-manual-linear_response"},[e("span",{class:"jlbinding"},"HarmonicBalance.LinearResponse.get_response")],-1)),s[32]||(s[32]=a()),t(n,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[33]||(s[33]=i(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">get_response</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    rmat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">HarmonicBalance.LinearResponse.ResponseMatrix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    s</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">OrderedCollections.OrderedDict</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Ω</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Any</span></span></code></pre></div><p>For <code>rmat</code> and a solution dictionary <code>s</code>, calculate the total response to a perturbative force at frequency <code>Ω</code>.</p><p><a href="https://github.com/NonlinearOscillations/HarmonicBalance.jl/blob/566f4e4ae8cae881d72420747776af3a152429ac/src/modules/LinearResponse/response.jl#L63" target="_blank" rel="noreferrer">source</a></p>`,3))]),e("details",v,[e("summary",null,[s[34]||(s[34]=e("a",{id:"HarmonicBalance.LinearResponse.get_response_matrix-manual-linear_response",href:"#HarmonicBalance.LinearResponse.get_response_matrix-manual-linear_response"},[e("span",{class:"jlbinding"},"HarmonicBalance.LinearResponse.get_response_matrix")],-1)),s[35]||(s[35]=a()),t(n,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[36]||(s[36]=i(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">get_response_matrix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    diff_eq</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DifferentialEquation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    freq</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Num</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    order</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Matrix</span></span></code></pre></div><p>Obtain the symbolic linear response matrix of a <code>diff_eq</code> corresponding to a perturbation frequency <code>freq</code>. This routine cannot accept a <code>HarmonicEquation</code> since there, some time-derivatives are already dropped. <code>order</code> denotes the highest differential order to be considered.</p><p><a href="https://github.com/NonlinearOscillations/HarmonicBalance.jl/blob/566f4e4ae8cae881d72420747776af3a152429ac/src/modules/LinearResponse/response.jl#L1" target="_blank" rel="noreferrer">source</a></p>`,3))])])}const V=o(h,[["render",F]]);export{A as __pageData,V as default};
