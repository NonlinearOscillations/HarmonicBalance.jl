<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Parametrically driven Duffing resonator · HarmonicBalance.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../background/harmonic_balance/"><img src="../../assets/logo.png" alt="HarmonicBalance.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../background/harmonic_balance/">HarmonicBalance.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><span class="tocitem">Background</span><ul><li><a class="tocitem" href="../../background/harmonic_balance/">The method of harmonic balance</a></li><li><a class="tocitem" href="../../background/stability_response/">Stability and linear response</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../single_Duffing/">Introduction: the Duffing oscillator</a></li><li><a class="tocitem" href="../linear_response/">Introduction: linear response</a></li><li><a class="tocitem" href="../time_dependent/">Introduction: time-dependent simulations</a></li><li class="is-active"><a class="tocitem" href>Parametrically driven Duffing resonator</a></li><li><a class="tocitem" href="../single_parametron_2D/">Phase diagrams and solutions in 2D: parametron</a></li><li><a class="tocitem" href="../single_parametron_time_dep/">Time-dependent simulations: parametron</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../manual/entering_eom/">Entering equations of motion</a></li><li><a class="tocitem" href="../../manual/extracting_harmonics/">Extracting harmonic equations</a></li><li><a class="tocitem" href="../../manual/solving_harmonics/">Solving harmonic equations</a></li><li><a class="tocitem" href="../../manual/plotting/">Analysis and plotting</a></li><li><a class="tocitem" href="../../manual/time_dependent/">Time evolution</a></li><li><a class="tocitem" href="../../manual/linear_response/">Linear response</a></li><li><a class="tocitem" href="../../manual/saving/">Saving and loading</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Parametrically driven Duffing resonator</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Parametrically driven Duffing resonator</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/NonlinearOscillations/HarmonicBalance.jl/blob/master/docs/src/examples/single_parametron_1D.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="parametron"><a class="docs-heading-anchor" href="#parametron">Parametrically driven Duffing resonator</a><a id="parametron-1"></a><a class="docs-heading-anchor-permalink" href="#parametron" title="Permalink"></a></h1><p>One of the most famous effects displaced by nonlinear oscillators is parametric resonance, where the frequency of the linear resonator is modulated in time  <a href="https://doi.org/10.1103/PhysRevE.94.022201">Phys. Rev. E 94, 022201 (2016)</a>. In the following we analyse this system, governed by the equations</p><p class="math-container">\[\ddot{x}(t)+\gamma\dot{x}(t)+\Omega^2(1-\lambda\cos(2\omega t + \psi))x + \alpha x^3 +\eta x^2 \dot{x}+F_\text{d}(t)=0\]</p><p>where for completeness we also considered an external drive term <span>$F_\text{d}(t)=F\cos(\omega t + \theta)$</span> and a nonlinear damping term <span>$\eta x^2 \dot{x}$</span></p><p>To implement this system in Harmonic Balance, we first import the library </p><pre><code class="language-julia hljs">using HarmonicBalance.jl</code></pre><p>Subsequently, we type define parameters in the problem and the oscillating amplitude function <span>$x(t)$</span> using the <code>variables</code> macro from <code>Symbolics.jl</code> </p><pre><code class="language-julia hljs">@variables Ω,γ,λ,F, x,θ,η,α, ω, ψ, x(t), t

natural_equation =  d(d(x,t),t) + γ*d(x,t) + Ω^2*(1-λ*cos(2*ω*t+ψ))*x + α * x^3 + η *d(x,t) * x^2
forces =  F*cos(ω*t+θ)
dEOM = HarmonicBalance.DifferentialEquation(natural_equation + forces, x)</code></pre><p>Note that an equation of the form  <span>$m \ddot{x}+m \omega_{0}^{2}\left(1-\lambda \cos (2\omega t+\psi)\right) x+\gamma \dot{x}+\alpha x^{3}+\eta x^{2} \dot{x}=F \cos \omega t$</span> can be brought to dimensionless form after a redefinition a scaling transformation described in <a href="https://doi.org/10.1103/PhysRevE.94.022201">Phys. Rev. E 94, 022201 (2016)</a>.</p><p>We are interested in studying the response of the oscillator to parametric driving and forcing. In particular, we focus on the first parametric resonance of the system, i.e. operating around twice the bare frequency of the undriven oscillator <span>$\omega$</span> while the frequency of the external drive is also <span>$\omega$</span>. For this purpose, we consider a harmonic ansatz which contains a single frequency: <span>$x(t)\approx u\cos(\omega t)+v\sin(\omega t)$</span>.   In HarmonicBalance, we can do this via <code>add_harmonic</code> command:</p><pre><code class="language-julia hljs">HarmonicBalance.add_harmonic!(dEOM, x, ω);</code></pre><p>and applying the perturbative averaging method, which replaces the full time dependent equation by time independent averaged equations of motion. This can be simply done by writing</p><pre><code class="language-julia hljs">@time averagedEOM = HarmonicBalance.get_harmonic_equations(dEOM)</code></pre><p>The output of these equations are consistent with the result found in the literature. Now are are interested in the linear response spectrum, which we can obtain from the solutions to the averaged equations (rotating frame) as a function of the external drive, after fixing all other parameters in the system. A call to <code>get_steady_states</code> then retrieves all steadystates found allong the sweep employing the homotopy continuation method, which occurs in a complex space (see the nice<a href="https://www.juliahomotopycontinuation.org">HomotopyContinuation.jl docs</a>)</p><pre><code class="language-julia hljs">fixed_parameters = (Ω =&gt; 1.0,γ =&gt; 1E-2, λ =&gt; 5E-2, F =&gt; 1E-3,  α =&gt; 1.,  η=&gt;0.3, θ =&gt; 0, ψ =&gt; 0)
sweep = ω =&gt; LinRange(0.9, 1.1, 100)

soln = HarmonicBalance.get_steady_states(averagedEOM, sweep, fixed_parameters, random_warmup=true, threading=false)</code></pre><p>In the last line we set the option <code>random_warmup=true</code> as a means to initiate the homotopy in a generalised version of the harmonic equations, where parameters become random complex numbers. A parameter homotopy then follows to each of the frequency values <span>$\omega$</span> in sweep. This offers speed-up, but requires to be tested in each scenario againts the option <code>random_warmup=false</code>, which initializes the homotopy in a total degree system (maximum number of roots), but needs to track significantly more homotopy paths and there is slower. The <code>threading</code> option enables parallel tracking of homotopy paths, and it&#39;s set to <code>false</code> simply because we are using a single core computer for now.</p><p>After solving the system, we can save the full output of the simulation and the model (e.g. symbolic expressions for the harmonic equations) into a file</p><pre><code class="language-julia hljs">HarmonicBalance.save(&quot;parametron_result.jld2&quot;, soln);</code></pre><p>During the execution of <code>get_steady_states</code>, different solution branches are classified by their proximity in complex space, with subsequent filtering of real (physically accceptable solutions). In addition, the stability properties of each steady state is assesed from the eigenvalues of the Jacobian matrix. All this information can be succintly represented in a 1D plot via</p><pre><code class="language-julia hljs">save_dict = HarmonicBalance.plot(soln, x=&quot;ω&quot;, y=&quot;sqrt(u1^2 + v1^2)&quot;, plot_only=[&quot;physical&quot;]);</code></pre><p>where <code>save_dict</code> is a dictionary that contains the plotted data and can be also exported if desired by setting a filename through the argument <code>filename</code> in <code>plot</code>. A call to the above function produces the following figure</p><p><img src="../../assets/single_parametron_1D.png" alt="fig1"/></p><p>The user can also can also introduce custom clases based on parameter conditions. Here we show some arbitrary example</p><pre><code class="language-julia hljs">plt = HarmonicBalance.plot(soln, x=&quot;ω&quot;, y=&quot;sqrt(u1^2 + v1^2)&quot;, marker_classification=&quot;ω^15 * sqrt(u1^2 + v1^2) &lt; 0.1&quot;)</code></pre><p>producing </p><p><img src="../../assets/single_parametron_1D_custom.png" alt="fig2"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../time_dependent/">« Introduction: time-dependent simulations</a><a class="docs-footer-nextpage" href="../single_parametron_2D/">Phase diagrams and solutions in 2D: parametron »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.18 on <span class="colophon-date" title="Thursday 26 May 2022 09:20">Thursday 26 May 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
